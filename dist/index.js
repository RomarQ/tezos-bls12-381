var Zt=Object.create;var k=Object.defineProperty;var Tt=Object.getOwnPropertyDescriptor;var _t=Object.getOwnPropertyNames;var At=Object.getPrototypeOf,It=Object.prototype.hasOwnProperty;var Ft=r=>k(r,"__esModule",{value:!0});var ot=(r=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(r,{get:(t,e)=>(typeof require!="undefined"?require:t)[e]}):r)(function(r){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+r+'" is not supported')});var J=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports);var Mt=(r,t,e)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of _t(t))!It.call(r,n)&&n!=="default"&&k(r,n,{get:()=>t[n],enumerable:!(e=Tt(t,n))||e.enumerable});return r},lt=r=>Mt(Ft(k(r!=null?Zt(At(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r);var Ot=J(m=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});m.psi2=m.psi=m.millerLoop=m.calcPairingPrecomputes=m.isogenyMapG2=m.map_to_curve_simple_swu_9mod16=m.ProjectivePoint=m.Fp12=m.Fp6=m.Fp2=m.Fr=m.Fp=m.powMod=m.mod=m.CURVE=void 0;m.CURVE={P:0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn,r:0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n,h:0x396c8c005555e1568c00aaab0000aaabn,Gx:0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bbn,Gy:0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1n,b:4n,P2:0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn**2n-1n,h2:0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5n,G2x:[0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8n,0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7en],G2y:[0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801n,0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79ben],b2:[4n,4n],x:0xd201000000010000n,h2Eff:0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551n};var tt=et(m.CURVE.x);function q(r,t){let e=r%t;return e>=0n?e:t+e}m.mod=q;function I(r,t,e){let n=1n;for(;t>0n;)t&1n&&(n=n*r%e),r=r*r%e,t>>=1n;return n}m.powMod=I;function zt(r,t){let e=t.length,n=new Array(e),i=r.ONE;for(let a=0;a<e;a++)t[a].isZero()||(n[a]=i,i=i.multiply(t[a]));i=i.invert();for(let a=e-1;a>=0;a--){if(t[a].isZero())continue;let s=i.multiply(t[a]);t[a]=i.multiply(n[a]),i=s}return t}function et(r){let t;for(t=0;r>0n;r>>=1n,t+=1);return t}function nt(r,t){return r>>BigInt(t)&1n}function ut(r,t=m.CURVE.P){if(r===0n||t<=0n)throw new Error(`invert: expected positive integers, got n=${r} mod=${t}`);let e=q(r,t),n=t,[i,a,s,c]=[0n,1n,1n,0n];for(;e!==0n;){let l=n/e,u=n%e,b=i-s*l,y=a-c*l;[n,e]=[e,u],[i,a]=[s,c],[s,c]=[b,y]}if(n!==1n)throw new Error("invert: does not exist");return q(i,t)}var g=class{constructor(t){this.value=q(t,g.ORDER)}isZero(){return this.value===0n}equals(t){return this.value===t.value}negate(){return new g(-this.value)}invert(){return new g(ut(this.value,g.ORDER))}add(t){return new g(this.value+t.value)}square(){return new g(this.value*this.value)}pow(t){return new g(I(this.value,t,g.ORDER))}sqrt(){let t=this.pow((g.ORDER+1n)/4n);if(!!t.square().equals(this))return t}subtract(t){return new g(this.value-t.value)}multiply(t){return t instanceof g&&(t=t.value),new g(this.value*t)}div(t){return typeof t=="bigint"&&(t=new g(t)),this.multiply(t.invert())}toString(){let t=this.value.toString(16).padStart(96,"0");return t.slice(0,2)+"."+t.slice(-2)}};m.Fp=g;g.ORDER=m.CURVE.P;g.MAX_BITS=et(m.CURVE.P);g.ZERO=new g(0n);g.ONE=new g(1n);var E=class{constructor(t){this.value=q(t,E.ORDER)}static isValid(t){return t<=E.ORDER}isZero(){return this.value===0n}equals(t){return this.value===t.value}negate(){return new E(-this.value)}invert(){return new E(ut(this.value,E.ORDER))}add(t){return new E(this.value+t.value)}square(){return new E(this.value*this.value)}pow(t){return new E(I(this.value,t,E.ORDER))}subtract(t){return new E(this.value-t.value)}multiply(t){return t instanceof E&&(t=t.value),new E(this.value*t)}div(t){return typeof t=="bigint"&&(t=new E(t)),this.multiply(t.invert())}legendre(){return this.pow((E.ORDER-1n)/2n)}sqrt(){if(!this.legendre().equals(E.ONE))return;let t=E.ORDER,e,n,i;for(e=t-1n,n=0;e%2n===0n;e/=2n,n++);if(n===1)return this.pow((t+1n)/4n);for(i=2n;i<t&&new E(i).legendre().value!==t-1n;i++);let a=I(i,e,t),s=I(this.value,(e+1n)/2n,t),c=I(this.value,e,t),o=0n;for(;q(c-1n,t)!==0n;){o=q(c*c,t);let l;for(l=1;l<n&&q(o-1n,t)!==0n;l++)o=q(o*o,t);let u=I(a,BigInt(1<<n-l-1),t);s=q(s*u,t),a=q(u*u,t),c=q(c*a,t),n=l}return new E(s)}toString(){return"0x"+this.value.toString(16).padStart(64,"0")}};m.Fr=E;E.ORDER=m.CURVE.r;E.ZERO=new E(0n);E.ONE=new E(1n);var Y=class{zip(t,e){let n=this.c,i=t.c,a=[];for(let s=0;s<n.length;s++)a.push(e(n[s],i[s]));return a}map(t){return this.c.map(t)}isZero(){return this.c.every(t=>t.isZero())}equals(t){return this.zip(t,(e,n)=>e.equals(n)).every(e=>e)}negate(){return this.init(this.map(t=>t.negate()))}add(t){return this.init(this.zip(t,(e,n)=>e.add(n)))}subtract(t){return this.init(this.zip(t,(e,n)=>e.subtract(n)))}conjugate(){return this.init([this.c[0],this.c[1].negate()])}one(){let t=this,e;return t instanceof d&&(e=d.ONE),t instanceof w&&(e=w.ONE),t instanceof v&&(e=v.ONE),e}pow(t){let e=this,n=this.one();if(t===0n)return n;if(t===1n)return e;let i=n,a=e;for(;t>0n;)t&1n&&(i=i.multiply(a)),t>>=1n,a=a.square();return i}div(t){let e=typeof t=="bigint"?new g(t).invert().value:t.invert();return this.multiply(e)}},d=class extends Y{constructor(t){super();if(t.length!==2)throw new Error("Expected array with 2 elements");t.forEach((e,n)=>{typeof e=="bigint"&&(t[n]=new g(e))}),this.c=t}init(t){return new d(t)}toString(){return`Fp2(${this.c[0]} + ${this.c[1]}\xD7i)`}get values(){return this.c.map(t=>t.value)}multiply(t){if(typeof t=="bigint")return new d(this.map(o=>o.multiply(t)));let[e,n]=this.c,[i,a]=t.c,s=e.multiply(i),c=n.multiply(a);return new d([s.subtract(c),e.add(n).multiply(i.add(a)).subtract(s.add(c))])}mulByNonresidue(){let t=this.c[0],e=this.c[1];return new d([t.subtract(e),t.add(e)])}square(){let t=this.c[0],e=this.c[1],n=t.add(e),i=t.subtract(e),a=t.add(t);return new d([n.multiply(i),a.multiply(e)])}sqrt(){let t=this.pow((d.ORDER+8n)/16n),e=t.square().div(this),n=xt,i=[n[0],n[2],n[4],n[6]].find(p=>p.equals(e));if(!i)return;let a=n.indexOf(i),s=n[a/2];if(!s)throw new Error("Invalid root");let c=t.div(s),o=c.negate(),[l,u]=c.values,[b,y]=o.values;return u>y||u===y&&l>b?c:o}invert(){let[t,e]=this.values,n=new g(t*t+e*e).invert();return new d([n.multiply(new g(t)),n.multiply(new g(-e))])}frobeniusMap(t){return new d([this.c[0],this.c[1].multiply(kt[t%2])])}multiplyByB(){let[t,e]=this.c,n=t.multiply(4n),i=e.multiply(4n);return new d([n.subtract(i),n.add(i)])}};m.Fp2=d;d.ORDER=m.CURVE.P2;d.MAX_BITS=et(m.CURVE.P2);d.ZERO=new d([0n,0n]);d.ONE=new d([1n,0n]);var w=class extends Y{constructor(t){super();if(this.c=t,t.length!==3)throw new Error("Expected array with 3 elements")}static fromTuple(t){if(!Array.isArray(t)||t.length!==6)throw new Error("Invalid Fp6 usage");return new w([new d(t.slice(0,2)),new d(t.slice(2,4)),new d(t.slice(4,6))])}init(t){return new w(t)}toString(){return`Fp6(${this.c[0]} + ${this.c[1]} * v, ${this.c[2]} * v^2)`}conjugate(){throw new TypeError("No conjugate on Fp6")}multiply(t){if(typeof t=="bigint")return new w([this.c[0].multiply(t),this.c[1].multiply(t),this.c[2].multiply(t)]);let[e,n,i]=this.c,[a,s,c]=t.c,o=e.multiply(a),l=n.multiply(s),u=i.multiply(c);return new w([o.add(n.add(i).multiply(s.add(c)).subtract(l.add(u)).mulByNonresidue()),e.add(n).multiply(a.add(s)).subtract(o.add(l)).add(u.mulByNonresidue()),l.add(e.add(i).multiply(a.add(c)).subtract(o.add(u)))])}mulByNonresidue(){return new w([this.c[2].mulByNonresidue(),this.c[0],this.c[1]])}multiplyBy1(t){return new w([this.c[2].multiply(t).mulByNonresidue(),this.c[0].multiply(t),this.c[1].multiply(t)])}multiplyBy01(t,e){let[n,i,a]=this.c,s=n.multiply(t),c=i.multiply(e);return new w([i.add(a).multiply(e).subtract(c).mulByNonresidue().add(s),t.add(e).multiply(n.add(i)).subtract(s).subtract(c),n.add(a).multiply(t).subtract(s).add(c)])}multiplyByFp2(t){return new w(this.map(e=>e.multiply(t)))}square(){let[t,e,n]=this.c,i=t.square(),a=t.multiply(e).multiply(2n),s=e.multiply(n).multiply(2n),c=n.square();return new w([s.mulByNonresidue().add(i),c.mulByNonresidue().add(a),a.add(t.subtract(e).add(n).square()).add(s).subtract(i).subtract(c)])}invert(){let[t,e,n]=this.c,i=t.square().subtract(n.multiply(e).mulByNonresidue()),a=n.square().mulByNonresidue().subtract(t.multiply(e)),s=e.square().subtract(t.multiply(n)),c=n.multiply(a).add(e.multiply(s)).mulByNonresidue().add(t.multiply(i)).invert();return new w([c.multiply(i),c.multiply(a),c.multiply(s)])}frobeniusMap(t){return new w([this.c[0].frobeniusMap(t),this.c[1].frobeniusMap(t).multiply(te[t%6]),this.c[2].frobeniusMap(t).multiply(ee[t%6])])}};m.Fp6=w;w.ZERO=new w([d.ZERO,d.ZERO,d.ZERO]);w.ONE=new w([d.ONE,d.ZERO,d.ZERO]);var v=class extends Y{constructor(t){super();if(this.c=t,t.length!==2)throw new Error("Expected array with 2 elements")}static fromTuple(t){return new v([w.fromTuple(t.slice(0,6)),w.fromTuple(t.slice(6,12))])}init(t){return new v(t)}toString(){return`Fp12(${this.c[0]} + ${this.c[1]} * w)`}multiply(t){if(typeof t=="bigint")return new v([this.c[0].multiply(t),this.c[1].multiply(t)]);let[e,n]=this.c,[i,a]=t.c,s=e.multiply(i),c=n.multiply(a);return new v([s.add(c.mulByNonresidue()),e.add(n).multiply(i.add(a)).subtract(s.add(c))])}multiplyBy014(t,e,n){let[i,a]=this.c,[s,c]=[i.multiplyBy01(t,e),a.multiplyBy1(n)];return new v([c.mulByNonresidue().add(s),a.add(i).multiplyBy01(t,e.add(n)).subtract(s).subtract(c)])}multiplyByFp2(t){return this.init(this.map(e=>e.multiplyByFp2(t)))}square(){let[t,e]=this.c,n=t.multiply(e);return new v([e.mulByNonresidue().add(t).multiply(t.add(e)).subtract(n).subtract(n.mulByNonresidue()),n.add(n)])}invert(){let[t,e]=this.c,n=t.square().subtract(e.square().mulByNonresidue()).invert();return new v([t.multiply(n),e.multiply(n).negate()])}frobeniusMap(t){let[e,n]=this.c,i=e.frobeniusMap(t),[a,s,c]=n.frobeniusMap(t).c,o=ne[t%12];return new v([i,new w([a.multiply(o),s.multiply(o),c.multiply(o)])])}Fp4Square(t,e){let n=t.square(),i=e.square();return[i.mulByNonresidue().add(n),t.add(e).square().subtract(n).subtract(i)]}cyclotomicSquare(){let[t,e]=this.c,[n,i,a]=t.c,[s,c,o]=e.c,[l,u]=this.Fp4Square(n,c),[b,y]=this.Fp4Square(s,a),[p,x]=this.Fp4Square(i,o),O=x.mulByNonresidue();return new v([new w([l.subtract(n).multiply(2n).add(l),b.subtract(i).multiply(2n).add(b),p.subtract(a).multiply(2n).add(p)]),new w([O.add(s).multiply(2n).add(O),u.add(c).multiply(2n).add(u),y.add(o).multiply(2n).add(y)])])}cyclotomicExp(t){let e=v.ONE;for(let n=tt-1;n>=0;n--)e=e.cyclotomicSquare(),nt(t,n)&&(e=e.multiply(this));return e}finalExponentiate(){let{x:t}=m.CURVE,e=this.frobeniusMap(6).div(this),n=e.frobeniusMap(2).multiply(e),i=n.cyclotomicExp(t).conjugate(),a=n.cyclotomicSquare().conjugate().multiply(i),s=a.cyclotomicExp(t).conjugate(),c=s.cyclotomicExp(t).conjugate(),o=c.cyclotomicExp(t).conjugate().multiply(i.cyclotomicSquare()),l=o.cyclotomicExp(t).conjugate(),u=i.multiply(c).frobeniusMap(2),b=s.multiply(n).frobeniusMap(3),y=o.multiply(n.conjugate()).frobeniusMap(1),p=l.multiply(a.conjugate()).multiply(n);return u.multiply(b).multiply(y).multiply(p)}};m.Fp12=v;v.ZERO=new v([w.ZERO,w.ZERO]);v.ONE=new v([w.ONE,w.ZERO]);var dt=class{constructor(t,e,n,i){this.x=t,this.y=e,this.z=n,this.C=i}isZero(){return this.z.isZero()}createPoint(t,e,n){return new this.constructor(t,e,n)}getZero(){return this.createPoint(this.C.ONE,this.C.ONE,this.C.ZERO)}equals(t){if(this.constructor!==t.constructor)throw new Error(`ProjectivePoint#equals: this is ${this.constructor}, but rhs is ${t.constructor}`);let e=this,n=t,i=e.x.multiply(n.z).equals(n.x.multiply(e.z)),a=e.y.multiply(n.z).equals(n.y.multiply(e.z));return i&&a}negate(){return this.createPoint(this.x,this.y.negate(),this.z)}toString(t=!0){if(!t)return`Point<x=${this.x}, y=${this.y}, z=${this.z}>`;let[e,n]=this.toAffine();return`Point<x=${e}, y=${n}>`}fromAffineTuple(t){return this.createPoint(t[0],t[1],this.C.ONE)}toAffine(t=this.z.invert()){return[this.x.multiply(t),this.y.multiply(t)]}toAffineBatch(t){let e=zt(this.C,t.map(n=>n.z));return t.map((n,i)=>n.toAffine(e[i]))}normalizeZ(t){return this.toAffineBatch(t).map(e=>this.fromAffineTuple(e))}double(){let{x:t,y:e,z:n}=this,i=t.multiply(t).multiply(3n),a=e.multiply(n),s=a.multiply(a),c=s.multiply(a),o=t.multiply(e).multiply(a),l=i.multiply(i).subtract(o.multiply(8n)),u=l.multiply(a).multiply(2n),b=i.multiply(o.multiply(4n).subtract(l)).subtract(e.multiply(e).multiply(8n).multiply(s)),y=c.multiply(8n);return this.createPoint(u,b,y)}add(t){if(this.constructor!==t.constructor)throw new Error(`ProjectivePoint#add: this is ${this.constructor}, but rhs is ${t.constructor}`);let e=this,n=t;if(e.isZero())return n;if(n.isZero())return e;let i=e.x,a=e.y,s=e.z,c=n.x,o=n.y,l=n.z,u=o.multiply(s),b=a.multiply(l),y=c.multiply(s),p=i.multiply(l);if(y.equals(p)&&u.equals(b))return this.double();if(y.equals(p))return this.getZero();let x=u.subtract(b),O=y.subtract(p),C=O.multiply(O),N=C.multiply(O),A=p.multiply(C),D=s.multiply(l),$=x.multiply(x).multiply(D).subtract(N).subtract(A.multiply(2n)),qt=O.multiply($),Ut=x.multiply(A.subtract($)).subtract(N.multiply(b)),Vt=N.multiply(D);return this.createPoint(qt,Ut,Vt)}subtract(t){if(this.constructor!==t.constructor)throw new Error(`ProjectivePoint#subtract: this is ${this.constructor}, but rhs is ${t.constructor}`);return this.add(t.negate())}validateScalar(t){if(typeof t=="number"&&(t=BigInt(t)),typeof t!="bigint"||t<=0||t>m.CURVE.r)throw new Error(`Point#multiply: invalid scalar, expected positive integer < CURVE.r. Got: ${t}`);return t}multiplyUnsafe(t){let e=this.validateScalar(t),n=this.getZero(),i=this;for(;e>0n;)e&1n&&(n=n.add(i)),i=i.double(),e>>=1n;return n}multiply(t){let e=this.validateScalar(t),n=this.getZero(),i=this.getZero(),a=this,s=g.ORDER;for(;s>0n;)e&1n?n=n.add(a):i=i.add(a),a=a.double(),e>>=1n,s>>=1n;return n}maxBits(){return this.C.MAX_BITS}precomputeWindow(t){let e=Math.ceil(this.maxBits()/t),n=2**(t-1),i=[],a=this,s=a;for(let c=0;c<e;c++){s=a,i.push(s);for(let o=1;o<n;o++)s=s.add(a),i.push(s);a=s.double()}return i}calcMultiplyPrecomputes(t){if(this._MPRECOMPUTES)throw new Error("This point already has precomputes");this._MPRECOMPUTES=[t,this.normalizeZ(this.precomputeWindow(t))]}clearMultiplyPrecomputes(){this._MPRECOMPUTES=void 0}wNAF(t){let e,n;this._MPRECOMPUTES?[e,n]=this._MPRECOMPUTES:(e=1,n=this.precomputeWindow(e));let[i,a]=[this.getZero(),this.getZero()],s=Math.ceil(this.maxBits()/e),c=2**(e-1),o=BigInt(2**e-1),l=2**e,u=BigInt(e);for(let b=0;b<s;b++){let y=b*c,p=Number(t&o);if(t>>=u,p>c&&(p-=l,t+=1n),p===0)a=a.add(b%2?n[y].negate():n[y]);else{let x=n[y+Math.abs(p)-1];i=i.add(p<0?x.negate():x)}}return[i,a]}multiplyPrecomputed(t){return this.wNAF(this.validateScalar(t))[0]}};m.ProjectivePoint=dt;function pt(r){let[t,e]=r.values,n=t%2n,i=t===0n,a=e%2n;return BigInt(n||i&&a)}var Ht=(m.CURVE.P**2n-9n)/16n;function Gt(r,t){let e=t.pow(7n),n=r.multiply(e),a=n.multiply(e.multiply(t)).pow(Ht).multiply(n),s=!1,c=a,o=xt.slice(0,4);for(let l of o){let u=l.multiply(a);u.pow(2n).multiply(t).subtract(r).isZero()&&!s&&(s=!0,c=u)}return[s,c]}function jt(r){let t=new d([0n,240n]),e=new d([1012n,1012n]),n=new d([-2n,-1n]);Array.isArray(r)&&(r=new d(r));let i=r.pow(2n),a=n.multiply(i),s=a.add(a.pow(2n)),c=t.multiply(s).negate(),o=e.multiply(s.add(d.ONE));c.isZero()&&(c=n.multiply(t));let l=c.pow(3n),u=o.pow(3n).add(t.multiply(o).multiply(c.pow(2n))).add(e.multiply(l)),[b,y]=Gt(u,l),p;b&&(p=y);let x=y.multiply(r.pow(3n));u=a.pow(3n).multiply(u);let O=!1;for(let C of Jt){let N=C.multiply(x);N.pow(2n).multiply(l).subtract(u).isZero()&&!b&&!O&&(p=N,O=!0)}if(!b&&!O)throw new Error("Hash to Curve - Optimized SWU failure");return O&&(o=o.multiply(a)),p=p,pt(r)!==pt(p)&&(p=p.negate()),p=p.multiply(c),[o,p,c]}m.map_to_curve_simple_swu_9mod16=jt;function Dt(r){let[t,e,n]=r,i=n.multiply(n),a=i.multiply(n),s=[n,i,a],c=[d.ZERO,d.ZERO,d.ZERO,d.ZERO];for(let b=0;b<vt.length;b++){let y=vt[b];c[b]=y.slice(-1)[0];let p=y.slice(0,-1).reverse();for(let x=0;x<p.length;x++){let O=p[x];c[b]=c[b].multiply(t).add(s[x].multiply(O))}}c[2]=c[2].multiply(e),c[3]=c[3].multiply(n);let o=c[1].multiply(c[3]),l=c[0].multiply(c[3]),u=c[1].multiply(c[2]);return[l,u,o]}m.isogenyMapG2=Dt;function $t(r,t){let[e,n,i]=[r,t,d.ONE],[a,s,c]=[e,n,i],o=[];for(let l=tt-2;l>=0;l--){let u=s.square(),b=c.square(),y=b.multiply(3n).multiplyByB(),p=y.multiply(3n),x=s.add(c).square().subtract(b).subtract(u);if(o.push([y.subtract(u),a.square().multiply(3n),x.negate()]),a=u.subtract(p).multiply(a).multiply(s).div(2n),s=u.add(p).div(2n).square().subtract(y.square().multiply(3n)),c=u.multiply(x),nt(m.CURVE.x,l)){let O=s.subtract(n.multiply(c)),C=a.subtract(e.multiply(c));o.push([O.multiply(e).subtract(C.multiply(n)),O.negate(),C]);let N=C.square(),A=N.multiply(C),D=N.multiply(a),$=A.subtract(D.multiply(2n)).add(O.square().multiply(c));a=C.multiply($),s=D.subtract($).multiply(O).subtract(A.multiply(s)),c=c.multiply(A)}}return o}m.calcPairingPrecomputes=$t;function Lt(r,t){let e=v.ONE,[n,i]=t,[a,s]=[n,i];for(let c=0,o=tt-2;o>=0;o--,c++)e=e.multiplyBy014(r[c][0],r[c][1].multiply(a.value),r[c][2].multiply(s.value)),nt(m.CURVE.x,o)&&(c+=1,e=e.multiplyBy014(r[c][0],r[c][1].multiply(a.value),r[c][2].multiply(s.value))),o!==0&&(e=e.square());return e.conjugate()}m.millerLoop=Lt;var bt=new w([d.ZERO,d.ONE,d.ZERO]),mt=new v([bt,w.ZERO]),Xt=mt.invert(),yt=new v([w.ZERO,bt]),Wt=yt.invert();function Kt(r,t){let e=Xt.multiplyByFp2(r).frobeniusMap(1).multiply(mt).c[0].c[0],n=Wt.multiplyByFp2(t).frobeniusMap(1).multiply(yt).c[0].c[0];return[e,n]}m.psi=Kt;function Yt(r,t){return[r.multiply(Qt),t.negate()]}m.psi2=Yt;var Qt=0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,T=0x6af0e0437ff400b6831e36d6bd17ffe48395dabc2d3435e77f76e17009241c5ee67992f72ec05f4c81084fbede3cc09n,ht=0x699be3b8c6870965e5bf892ad5d2cc7b0e85a117402dfd83b7f4a947e02d978498255a2aaec0ac627b5afbdf1bf1c90n,wt=0x8157cd83046453f5dd0972b6e3949e4288020b5b8a9cc99ca07e27089a2ce2436d965026adad3ef7baba37f2183e9b5n,gt=0xab1c2ffdd6c253ca155231eb3e71ba044fd562f6f72bc5bad5ec46a0b7a3b0247cf08ce6c6317f40edbc653a72dee17n,Et=0xaa404866706722864480885d68ad0ccac1967c7544b447873cc37e0181271e006df72162a3d3e0287bf597fbf7f8fc1n,kt=[0x1n,0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaaan].map(r=>new g(r)),xt=[[1n,0n],[T,-T],[0n,1n],[T,T],[-1n,0n],[-T,T],[0n,-1n],[-T,-T]].map(r=>new d(r)),Jt=[[ht,wt],[-wt,ht],[gt,Et],[-Et,gt]].map(r=>new d(r)),te=[[0x1n,0x0n],[0x0n,0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn],[0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,0x0n],[0x0n,0x1n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,0x0n],[0x0n,0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen]].map(r=>new d(r)),ee=[[0x1n,0x0n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaadn,0x0n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,0x0n],[0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaaan,0x0n],[0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,0x0n],[0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffeffffn,0x0n]].map(r=>new d(r)),ne=[[0x1n,0x0n],[0x1904d3bf02bb0667c231beb4202c0d1f0fd603fd3cbd5f4f7b2443d784bab9c4f67ea53d63e7813d8d0775ed92235fb8n,0x00fc3e2b36c4e03288e9e902231f9fb854a14787b6c7b36fec0c8ec971f63c5f282d5ac14d6c7ec22cf78a126ddc4af3n],[0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffeffffn,0x0n],[0x135203e60180a68ee2e9c448d77a2cd91c3dedd930b1cf60ef396489f61eb45e304466cf3e67fa0af1ee7b04121bdea2n,0x06af0e0437ff400b6831e36d6bd17ffe48395dabc2d3435e77f76e17009241c5ee67992f72ec05f4c81084fbede3cc09n],[0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,0x0n],[0x144e4211384586c16bd3ad4afa99cc9170df3560e77982d0db45f3536814f0bd5871c1908bd478cd1ee605167ff82995n,0x05b2cfd9013a5fd8df47fa6b48b1e045f39816240c0b8fee8beadf4d8e9c0566c63a3e6e257f87329b18fae980078116n],[0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaaan,0x0n],[0x00fc3e2b36c4e03288e9e902231f9fb854a14787b6c7b36fec0c8ec971f63c5f282d5ac14d6c7ec22cf78a126ddc4af3n,0x1904d3bf02bb0667c231beb4202c0d1f0fd603fd3cbd5f4f7b2443d784bab9c4f67ea53d63e7813d8d0775ed92235fb8n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,0x0n],[0x06af0e0437ff400b6831e36d6bd17ffe48395dabc2d3435e77f76e17009241c5ee67992f72ec05f4c81084fbede3cc09n,0x135203e60180a68ee2e9c448d77a2cd91c3dedd930b1cf60ef396489f61eb45e304466cf3e67fa0af1ee7b04121bdea2n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaadn,0x0n],[0x05b2cfd9013a5fd8df47fa6b48b1e045f39816240c0b8fee8beadf4d8e9c0566c63a3e6e257f87329b18fae980078116n,0x144e4211384586c16bd3ad4afa99cc9170df3560e77982d0db45f3536814f0bd5871c1908bd478cd1ee605167ff82995n]].map(r=>new d(r)),re=[[0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6n,0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6n],[0x0n,0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71an],[0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71en,0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38dn],[0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1n,0x0n]].map(r=>new d(r)),ie=[[0x0n,0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63n],[0xcn,0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9fn],[0x1n,0x0n],[0x0n,0x0n]].map(r=>new d(r)),ae=[[0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706n,0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706n],[0x0n,0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97ben],[0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71cn,0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38fn],[0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10n,0x0n]].map(r=>new d(r)),se=[[0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fbn,0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fbn],[0x0n,0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3n],[0x12n,0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99n],[0x1n,0x0n]].map(r=>new d(r)),vt=[re,ie,ae,se]});var Rt=J(()=>{});var ft=J((h,Ct)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});h.verifyBatch=h.aggregateSignatures=h.aggregatePublicKeys=h.verify=h.sign=h.getPublicKey=h.pairing=h.PointG2=h.PointG1=h.utils=h.CURVE=h.Fp12=h.Fp2=h.Fr=h.Fp=void 0;var f=Ot();Object.defineProperty(h,"Fp",{enumerable:!0,get:function(){return f.Fp}});Object.defineProperty(h,"Fr",{enumerable:!0,get:function(){return f.Fr}});Object.defineProperty(h,"Fp2",{enumerable:!0,get:function(){return f.Fp2}});Object.defineProperty(h,"Fp12",{enumerable:!0,get:function(){return f.Fp12}});Object.defineProperty(h,"CURVE",{enumerable:!0,get:function(){return f.CURVE}});var F=2n**381n,M=F*2n,H=M*2n,R=48,ce=32,rt={DST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",p:f.CURVE.P,m:2,k:128,expand:!0};function Pt(r){return 0<r&&r<f.CURVE.r}var _=(()=>{let r=typeof self=="object"&&"crypto"in self?self.crypto:void 0;return{node:typeof Ct!="undefined"&&typeof ot=="function"&&!r?Rt():void 0,web:r}})();h.utils={hashToField:Bt,randomBytes:(r=32)=>{if(_.web)return _.web.getRandomValues(new Uint8Array(r));if(_.node){let{randomBytes:t}=_.node;return new Uint8Array(t(r).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>{let r=8;for(;r--;){let t=h.utils.randomBytes(32),e=U(t);if(Pt(e)&&e!==1n)return t}throw new Error("Valid private key was not found in 8 iterations. PRNG is broken")},sha256:async r=>{if(_.web){let t=await _.web.subtle.digest("SHA-256",r.buffer);return new Uint8Array(t)}else{if(_.node)return Uint8Array.from(_.node.createHash("sha256").update(r).digest());throw new Error("The environment doesn't have sha256 function")}},mod:f.mod,getDSTLabel(){return rt.DST},setDSTLabel(r){if(typeof r!="string"||r.length>2048||r.length===0)throw new TypeError("Invalid DST");rt.DST=r}};function U(r){let t=0n;for(let e=r.length-1,n=0;e>=0;e--,n++)t+=(BigInt(r[e])&255n)<<8n*BigInt(n);return t}function St(r){let t="";for(let e=0;e<r.length;e++)t+=r[e].toString(16).padStart(2,"0");return t}function L(r){if(typeof r!="string")throw new TypeError("hexToBytes: expected string, got "+typeof r);if(r.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let t=new Uint8Array(r.length/2);for(let e=0;e<t.length;e++){let n=e*2;t[e]=Number.parseInt(r.slice(n,n+2),16)}return t}function V(r,t){if(r<0n)throw new Error("Expected valid number");if(typeof t!="number")throw new TypeError("Expected valid padding");return r.toString(16).padStart(t*2,"0")}function Q(r){if(r instanceof Uint8Array)return r;if(typeof r=="string")return L(r);throw new TypeError("Expected hex string or Uint8Array")}function X(...r){if(r.length===1)return r[0];let t=r.reduce((n,i)=>n+i.length,0),e=new Uint8Array(t);for(let n=0,i=0;n<r.length;n++){let a=r[n];e.set(a,i),i+=a.length}return e}function fe(r){let t=new Uint8Array(r.length);for(let e=0;e<r.length;e++)t[e]=r.charCodeAt(e);return t}function oe(r){let t=0n;for(let e=0;e<r.length;e++)t<<=8n,t+=BigInt(r[e]);return t}function G(r,t){if(r<0||r>=1<<8*t)throw new Error(`bad I2OSP call: value=${r} length=${t}`);let e=Array.from({length:t}).fill(0);for(let n=t-1;n>=0;n--)e[n]=r&255,r>>>=8;return new Uint8Array(e)}function le(r,t){let e=new Uint8Array(r.length);for(let n=0;n<r.length;n++)e[n]=r[n]^t[n];return e}async function ue(r,t,e){let n=h.utils.sha256,i=ce,a=i*2,s=Math.ceil(e/i);if(s>255)throw new Error("Invalid xmd length");let c=X(t,G(t.length,1)),o=G(0,a),l=G(e,2),u=new Array(s),b=await n(X(o,r,l,G(0,1),c));u[0]=await n(X(b,G(1,1),c));for(let p=1;p<=s;p++){let x=[le(b,u[p-1]),G(p+1,1),c];u[p]=await n(X(...x))}return X(...u).slice(0,e)}async function Bt(r,t,e={}){let n={...rt,...e},i=n.p.toString(2).length,a=Math.ceil((i+n.k)/8),s=t*n.m*a,c=fe(n.DST),o=r;n.expand&&(o=await ue(r,c,s));let l=new Array(t);for(let u=0;u<t;u++){let b=new Array(n.m);for(let y=0;y<n.m;y++){let p=a*(y+u*n.m),x=o.slice(p,p+a);b[y]=(0,f.mod)(oe(x),n.p)}l[u]=b}return l}function it(r){let t;if(r instanceof Uint8Array&&r.length===32)t=U(r);else if(typeof r=="string"&&r.length===64)t=BigInt(`0x${r}`);else if(typeof r=="number"&&r>0&&Number.isSafeInteger(r))t=BigInt(r);else if(typeof r=="bigint"&&r>0n)t=r;else throw new TypeError("Expected valid private key");if(t=(0,f.mod)(t,f.CURVE.r),!Pt(t))throw new Error("Private key must be 0 < key < CURVE.r");return t}function j(r,t){if(!(r instanceof t))throw new Error("Expected Fp* argument, not number/bigint")}var S=class extends f.ProjectivePoint{constructor(t,e,n=f.Fp.ONE){super(t,e,n,f.Fp);j(t,f.Fp),j(e,f.Fp),j(n,f.Fp)}static fromHex(t){t=Q(t);let{P:e}=f.CURVE,n;if(t.length===48){let i=U(t);if((0,f.mod)(i,H)/M===1n)return this.ZERO;let s=new f.Fp((0,f.mod)(i,F)),o=s.pow(3n).add(new f.Fp(f.CURVE.b)).sqrt();if(!o)throw new Error("Invalid compressed G1 point");let l=(0,f.mod)(i,M)/F;o.value*2n/e!==l&&(o=o.negate()),n=new S(s,o)}else if(t.length===96){if((t[0]&1<<6)!=0)return S.ZERO;let i=U(t.slice(0,R)),a=U(t.slice(R));n=new S(new f.Fp(i),new f.Fp(a))}else throw new Error("Invalid point G1, expected 48/96 bytes");return n.assertValidity(),n}static fromPrivateKey(t){return this.BASE.multiplyPrecomputed(it(t))}toRawBytes(t=!1){return L(this.toHex(t))}toHex(t=!1){this.assertValidity();let{P:e}=f.CURVE;if(t){let n;if(this.isZero())n=H+M;else{let[i,a]=this.toAffine(),s=a.value*2n/e;n=i.value+s*F+H}return V(n,R)}else{if(this.isZero())return"4".padEnd(2*2*R,"0");{let[n,i]=this.toAffine();return V(n.value,R)+V(i.value,R)}}}assertValidity(){if(this.isZero())return this;if(!this.isOnCurve())throw new Error("Invalid G1 point: not on curve Fp");if(!this.isTorsionFree())throw new Error("Invalid G1 point: must be of prime-order subgroup");return this}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}millerLoop(t){return(0,f.millerLoop)(t.pairingPrecomputes(),this.toAffine())}clearCofactor(){return this.multiplyUnsafe(f.CURVE.h)}isOnCurve(){let t=new f.Fp(f.CURVE.b),{x:e,y:n,z:i}=this,a=n.pow(2n).multiply(i).subtract(e.pow(3n)),s=t.multiply(i.pow(3n));return a.subtract(s).isZero()}sigma(){let t=0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,[e,n]=this.toAffine();return new S(e.multiply(t),n)}isTorsionFree(){let t=0x396c8c005555e1560000000055555555n,e=this,n=e.sigma(),i=n.double(),a=n.sigma();return i.subtract(e).subtract(a).multiplyUnsafe(t).subtract(a).isZero()}};h.PointG1=S;S.BASE=new S(new f.Fp(f.CURVE.Gx),new f.Fp(f.CURVE.Gy),f.Fp.ONE);S.ZERO=new S(f.Fp.ONE,f.Fp.ONE,f.Fp.ZERO);var P=class extends f.ProjectivePoint{constructor(t,e,n=f.Fp2.ONE){super(t,e,n,f.Fp2);j(t,f.Fp2),j(e,f.Fp2),j(n,f.Fp2)}static async hashToCurve(t){t=Q(t);let e=await Bt(t,2),n=new P(...(0,f.isogenyMapG2)((0,f.map_to_curve_simple_swu_9mod16)(e[0]))),i=new P(...(0,f.isogenyMapG2)((0,f.map_to_curve_simple_swu_9mod16)(e[1])));return n.add(i).clearCofactor()}static fromSignature(t){t=Q(t);let{P:e}=f.CURVE,n=t.length/2;if(n!==48&&n!==96)throw new Error("Invalid compressed signature length, must be 96 or 192");let i=U(t.slice(0,n)),a=U(t.slice(n));if((0,f.mod)(i,H)/M===1n)return this.ZERO;let c=i%F,o=a,l=new f.Fp2([o,c]),b=l.pow(3n).add(new f.Fp2(f.CURVE.b2)).sqrt();if(!b)throw new Error("Failed to find a square root");let[y,p]=b.values,x=i%M/F,O=p>0n&&p*2n/e!==x,C=p===0n&&y*2n/e!==x;(O||C)&&(b=b.multiply(-1n));let N=new P(l,b,f.Fp2.ONE);return N.assertValidity(),N}static fromHex(t){t=Q(t);let e;if(t.length===96)throw new Error("Compressed format not supported yet.");if(t.length===192){if((t[0]&1<<6)!=0)return P.ZERO;let n=U(t.slice(0,R)),i=U(t.slice(R,2*R)),a=U(t.slice(2*R,3*R)),s=U(t.slice(3*R));e=new P(new f.Fp2([i,n]),new f.Fp2([s,a]))}else throw new Error("Invalid uncompressed point G2, expected 192 bytes");return e.assertValidity(),e}static fromPrivateKey(t){return this.BASE.multiplyPrecomputed(it(t))}toSignature(){if(this.equals(P.ZERO)){let l=H+M;return V(l,R)+V(0n,R)}let[[t,e],[n,i]]=this.toAffine().map(l=>l.values),s=(i>0n?i*2n:n*2n)/f.CURVE.P,c=e+s*F+H,o=t;return V(c,R)+V(o,R)}toRawBytes(t=!1){return L(this.toHex(t))}toHex(t=!1){if(this.assertValidity(),t)throw new Error("Point compression has not yet been implemented");{if(this.equals(P.ZERO))return"4".padEnd(2*4*R,"0");let[[e,n],[i,a]]=this.toAffine().map(s=>s.values);return V(n,R)+V(e,R)+V(a,R)+V(i,R)}}assertValidity(){if(this.isZero())return this;if(!this.isOnCurve())throw new Error("Invalid G2 point: not on curve Fp2");if(!this.isTorsionFree())throw new Error("Invalid G2 point: must be of prime-order subgroup");return this}psi(){return this.fromAffineTuple((0,f.psi)(...this.toAffine()))}psi2(){return this.fromAffineTuple((0,f.psi2)(...this.toAffine()))}mulNegX(){return this.multiplyUnsafe(f.CURVE.x).negate()}clearCofactor(){let t=this,e=t.mulNegX(),n=t.psi(),i=t.double();return i=i.psi2(),i=i.subtract(n),n=e.add(n),n=n.mulNegX(),i=i.add(n),i=i.subtract(e),i.subtract(t)}isOnCurve(){let t=new f.Fp2(f.CURVE.b2),{x:e,y:n,z:i}=this,a=n.pow(2n).multiply(i).subtract(e.pow(3n)),s=t.multiply(i.pow(3n));return a.subtract(s).isZero()}isTorsionFree(){let t=this,e=t.psi2();return e.psi().mulNegX().subtract(e).add(t).isZero()}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}clearPairingPrecomputes(){this._PPRECOMPUTES=void 0}pairingPrecomputes(){return this._PPRECOMPUTES?this._PPRECOMPUTES:(this._PPRECOMPUTES=(0,f.calcPairingPrecomputes)(...this.toAffine()),this._PPRECOMPUTES)}};h.PointG2=P;P.BASE=new P(new f.Fp2(f.CURVE.G2x),new f.Fp2(f.CURVE.G2y),f.Fp2.ONE);P.ZERO=new P(f.Fp2.ONE,f.Fp2.ONE,f.Fp2.ZERO);function W(r,t,e=!0){if(r.isZero()||t.isZero())throw new Error("No pairings at point of Infinity");r.assertValidity(),t.assertValidity();let n=r.millerLoop(t);return e?n.finalExponentiate():n}h.pairing=W;function at(r){return r instanceof S?r:S.fromHex(r)}function st(r){return r instanceof P?r:P.fromSignature(r)}async function ct(r){return r instanceof P?r:P.hashToCurve(r)}function de(r){let t=S.fromPrivateKey(r).toRawBytes(!0);return typeof r=="string"?St(t):t}h.getPublicKey=de;async function pe(r,t){let e=await ct(r);e.assertValidity();let n=e.multiply(it(t));if(r instanceof P)return n;let i=n.toSignature();return typeof r=="string"?i:L(i)}h.sign=pe;async function be(r,t,e){let n=at(e),i=await ct(t),a=S.BASE,s=st(r),c=W(n.negate(),i,!1);return W(a,s,!1).multiply(c).finalExponentiate().equals(f.Fp12.ONE)}h.verify=be;function me(r){if(!r.length)throw new Error("Expected non-empty array");let t=r.map(at).reduce((n,i)=>n.add(i),S.ZERO);if(r[0]instanceof S)return t.assertValidity();let e=t.toRawBytes(!0);return r[0]instanceof Uint8Array?e:St(e)}h.aggregatePublicKeys=me;function ye(r){if(!r.length)throw new Error("Expected non-empty array");let t=r.map(st).reduce((n,i)=>n.add(i),P.ZERO);if(r[0]instanceof P)return t.assertValidity();let e=t.toSignature();return r[0]instanceof Uint8Array?L(e):e}h.aggregateSignatures=ye;async function he(r,t,e){if(!t.length)throw new Error("Expected non-empty messages array");if(e.length!==t.length)throw new Error("Pubkey count should equal msg count");let n=st(r),i=await Promise.all(t.map(ct)),a=e.map(at);try{let s=[];for(let l of new Set(i)){let u=i.reduce((b,y,p)=>y===l?b.add(a[p]):b,S.ZERO);s.push(W(u,l,!1))}return s.push(W(S.BASE.negate(),n,!1)),s.reduce((l,u)=>l.multiply(u),f.Fp12.ONE).finalExponentiate().equals(f.Fp12.ONE)}catch{return!1}}h.verifyBatch=he;S.BASE.calcMultiplyPrecomputes(4)});var B=lt(ft());var Nt=lt(ft()),z=r=>new Nt.Fr(K(Z(r))),Z=r=>{r.startsWith("0x")&&(r=r.slice(2));let t=r.length,e="";for(let n=0;n<t/2;n++)e+=r.substring(t-(n+1)*2,t-n*2);return e},K=r=>BigInt(`0x${r}`);var we=(r,t)=>{let e=B.PointG1.fromHex(r);e.assertValidity();let n=B.PointG1.fromHex(t);return n.assertValidity(),e.add(n).toHex()},ge=r=>{let t=B.PointG1.fromHex(r).negate();return t.assertValidity(),t.toHex()},Ee=(r,t)=>{let e=B.PointG1.fromHex(r);return e.assertValidity(),e.multiply(K(Z(t))).toHex()},xe=(r,t)=>{let e=B.PointG2.fromHex(r);e.assertValidity();let n=B.PointG2.fromHex(t);return n.assertValidity(),e.add(n).toHex()},ve=r=>{let t=B.PointG2.fromHex(r).negate();return t.assertValidity(),t.toHex()},Oe=(r,t)=>{let e=B.PointG2.fromHex(r);return e.assertValidity(),e.multiply(K(Z(t))).toHex()},Re=(r,t)=>{let e=z(r),n=z(t);return Z(e.add(n).toString())},Pe=r=>{let t=z(r);return Z(t.negate().toString())},Se=(r,t)=>{let e=z(r),n=z(t);return Z(e.multiply(n).toString())},Be=(r,t)=>Z(z(r).multiply(BigInt(t)).toString()),Ce=r=>K(Z(r)).toString(10),Ne=r=>{let t=!0;if(r.length>0){let e=B.PointG1.fromHex(r[0][0]);e.assertValidity();let n=B.PointG2.fromHex(r[0][1]);n.assertValidity();let i=B.PointG1.fromHex(r[1][0]);i.assertValidity();let a=B.PointG2.fromHex(r[1][1]);a.assertValidity();let s=(0,B.pairing)(e,n),c=(0,B.pairing)(i,a);t=s.multiply(c).equals(B.Fp12.ONE)}return t},qe={addG1:we,addG2:xe,addFr:Re,multiplyG1ByFr:Ee,multiplyG2ByFr:Oe,multiplyFrByFr:Se,multiplyFrByInt:Be,negateG1:ge,negateG2:ve,negateFr:Pe,convertFrToInt:Ce,pairingCheck:Ne},Ie=qe;export{Ie as default};
/*! noble-bls12-381 - MIT License (c) Paul Miller (paulmillr.com) */
//# sourceMappingURL=index.js.map
