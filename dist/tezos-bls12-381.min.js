var Bls12=function(){"use strict";function t(t){var e={exports:{}};return t(e,e.exports),e.exports}function e(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets option of @rollup/plugin-commonjs appropriately for this require call to behave properly.')}var n=t((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.psi2=e.psi=e.millerLoop=e.calcPairingPrecomputes=e.isogenyMapG2=e.map_to_curve_simple_swu_9mod16=e.ProjectivePoint=e.Fp12=e.Fp6=e.Fp2=e.Fr=e.Fp=e.powMod=e.mod=e.CURVE=void 0,e.CURVE={P:0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn,r:0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n,h:0x396c8c005555e1568c00aaab0000aaabn,Gx:0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bbn,Gy:0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1n,b:4n,P2:0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn**2n-1n,h2:0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5n,G2x:[0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8n,0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7en],G2y:[0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801n,0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79ben],b2:[4n,4n],x:0xd201000000010000n,h2Eff:0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551n};const n=i(e.CURVE.x);function r(t,e){const n=t%e;return n>=0n?n:e+n}function a(t,e,n){let r=1n;for(;e>0n;)1n&e&&(r=r*t%n),t=t*t%n,e>>=1n;return r}function i(t){let e;for(e=0;t>0n;t>>=1n,e+=1);return e}function f(t,e){return t>>BigInt(e)&1n}function u(t,n=e.CURVE.P){if(0n===t||n<=0n)throw new Error(`invert: expected positive integers, got n=${t} mod=${n}`);let a=r(t,n),i=n,[f,u,s,c]=[0n,1n,1n,0n];for(;0n!==a;){const t=i/a,e=i%a,n=f-s*t,r=u-c*t;[i,a]=[a,e],[f,u]=[s,c],[s,c]=[n,r]}if(1n!==i)throw new Error("invert: does not exist");return r(f,n)}e.mod=r,e.powMod=a;class s{constructor(t){this.value=r(t,s.ORDER)}isZero(){return 0n===this.value}equals(t){return this.value===t.value}negate(){return new s(-this.value)}invert(){return new s(u(this.value,s.ORDER))}add(t){return new s(this.value+t.value)}square(){return new s(this.value*this.value)}pow(t){return new s(a(this.value,t,s.ORDER))}sqrt(){const t=this.pow((s.ORDER+1n)/4n);if(t.square().equals(this))return t}subtract(t){return new s(this.value-t.value)}multiply(t){return t instanceof s&&(t=t.value),new s(this.value*t)}div(t){return"bigint"==typeof t&&(t=new s(t)),this.multiply(t.invert())}toString(){const t=this.value.toString(16).padStart(96,"0");return t.slice(0,2)+"."+t.slice(-2)}}e.Fp=s,s.ORDER=e.CURVE.P,s.MAX_BITS=i(e.CURVE.P),s.ZERO=new s(0n),s.ONE=new s(1n);class c{constructor(t){this.value=r(t,c.ORDER)}static isValid(t){return t<=c.ORDER}isZero(){return 0n===this.value}equals(t){return this.value===t.value}negate(){return new c(-this.value)}invert(){return new c(u(this.value,c.ORDER))}add(t){return new c(this.value+t.value)}square(){return new c(this.value*this.value)}pow(t){return new c(a(this.value,t,c.ORDER))}subtract(t){return new c(this.value-t.value)}multiply(t){return t instanceof c&&(t=t.value),new c(this.value*t)}div(t){return"bigint"==typeof t&&(t=new c(t)),this.multiply(t.invert())}legendre(){return this.pow((c.ORDER-1n)/2n)}sqrt(){if(!this.legendre().equals(c.ONE))return;const t=c.ORDER;let e,n,i;for(e=t-1n,n=0;e%2n===0n;e/=2n,n++);if(1===n)return this.pow((t+1n)/4n);for(i=2n;i<t&&new c(i).legendre().value!==t-1n;i++);let f=a(i,e,t),u=a(this.value,(e+1n)/2n,t),s=a(this.value,e,t),l=0n;for(;0n!==r(s-1n,t);){let e;for(l=r(s*s,t),e=1;e<n&&0n!==r(l-1n,t);e++)l=r(l*l,t);let i=a(f,BigInt(1<<n-e-1),t);u=r(u*i,t),f=r(i*i,t),s=r(s*f,t),n=e}return new c(u)}toString(){return"0x"+this.value.toString(16).padStart(64,"0")}}e.Fr=c,c.ORDER=e.CURVE.r,c.ZERO=new c(0n),c.ONE=new c(1n);class l{zip(t,e){const n=this.c,r=t.c,a=[];for(let t=0;t<n.length;t++)a.push(e(n[t],r[t]));return a}map(t){return this.c.map(t)}isZero(){return this.c.every((t=>t.isZero()))}equals(t){return this.zip(t,((t,e)=>t.equals(e))).every((t=>t))}negate(){return this.init(this.map((t=>t.negate())))}add(t){return this.init(this.zip(t,((t,e)=>t.add(e))))}subtract(t){return this.init(this.zip(t,((t,e)=>t.subtract(e))))}conjugate(){return this.init([this.c[0],this.c[1].negate()])}one(){const t=this;let e;return t instanceof o&&(e=o.ONE),t instanceof d&&(e=d.ONE),t instanceof p&&(e=p.ONE),e}pow(t){const e=this.one();if(0n===t)return e;if(1n===t)return this;let n=e,r=this;for(;t>0n;)1n&t&&(n=n.multiply(r)),t>>=1n,r=r.square();return n}div(t){const e="bigint"==typeof t?new s(t).invert().value:t.invert();return this.multiply(e)}}class o extends l{constructor(t){if(super(),2!==t.length)throw new Error("Expected array with 2 elements");t.forEach(((e,n)=>{"bigint"==typeof e&&(t[n]=new s(e))})),this.c=t}init(t){return new o(t)}toString(){return`Fp2(${this.c[0]} + ${this.c[1]}Ã—i)`}get values(){return this.c.map((t=>t.value))}multiply(t){if("bigint"==typeof t)return new o(this.map((e=>e.multiply(t))));const[e,n]=this.c,[r,a]=t.c;let i=e.multiply(r),f=n.multiply(a);return new o([i.subtract(f),e.add(n).multiply(r.add(a)).subtract(i.add(f))])}mulByNonresidue(){const t=this.c[0],e=this.c[1];return new o([t.subtract(e),t.add(e)])}square(){const t=this.c[0],e=this.c[1],n=t.add(e),r=t.subtract(e),a=t.add(t);return new o([n.multiply(r),a.multiply(e)])}sqrt(){const t=this.pow((o.ORDER+8n)/16n),e=t.square().div(this),n=S,r=[n[0],n[2],n[4],n[6]].find((t=>t.equals(e)));if(!r)return;const a=n.indexOf(r),i=n[a/2];if(!i)throw new Error("Invalid root");const f=t.div(i),u=f.negate(),[s,c]=f.values,[l,d]=u.values;return c>d||c===d&&s>l?f:u}invert(){const[t,e]=this.values,n=new s(t*t+e*e).invert();return new o([n.multiply(new s(t)),n.multiply(new s(-e))])}frobeniusMap(t){return new o([this.c[0],this.c[1].multiply(B[t%2])])}multiplyByB(){let[t,e]=this.c,n=t.multiply(4n),r=e.multiply(4n);return new o([n.subtract(r),n.add(r)])}}e.Fp2=o,o.ORDER=e.CURVE.P2,o.MAX_BITS=i(e.CURVE.P2),o.ZERO=new o([0n,0n]),o.ONE=new o([1n,0n]);class d extends l{constructor(t){if(super(),this.c=t,3!==t.length)throw new Error("Expected array with 3 elements")}static fromTuple(t){if(!Array.isArray(t)||6!==t.length)throw new Error("Invalid Fp6 usage");return new d([new o(t.slice(0,2)),new o(t.slice(2,4)),new o(t.slice(4,6))])}init(t){return new d(t)}toString(){return`Fp6(${this.c[0]} + ${this.c[1]} * v, ${this.c[2]} * v^2)`}conjugate(){throw new TypeError("No conjugate on Fp6")}multiply(t){if("bigint"==typeof t)return new d([this.c[0].multiply(t),this.c[1].multiply(t),this.c[2].multiply(t)]);let[e,n,r]=this.c;const[a,i,f]=t.c;let u=e.multiply(a),s=n.multiply(i),c=r.multiply(f);return new d([u.add(n.add(r).multiply(i.add(f)).subtract(s.add(c)).mulByNonresidue()),e.add(n).multiply(a.add(i)).subtract(u.add(s)).add(c.mulByNonresidue()),s.add(e.add(r).multiply(a.add(f)).subtract(u.add(c)))])}mulByNonresidue(){return new d([this.c[2].mulByNonresidue(),this.c[0],this.c[1]])}multiplyBy1(t){return new d([this.c[2].multiply(t).mulByNonresidue(),this.c[0].multiply(t),this.c[1].multiply(t)])}multiplyBy01(t,e){let[n,r,a]=this.c,i=n.multiply(t),f=r.multiply(e);return new d([r.add(a).multiply(e).subtract(f).mulByNonresidue().add(i),t.add(e).multiply(n.add(r)).subtract(i).subtract(f),n.add(a).multiply(t).subtract(i).add(f)])}multiplyByFp2(t){return new d(this.map((e=>e.multiply(t))))}square(){let[t,e,n]=this.c,r=t.square(),a=t.multiply(e).multiply(2n),i=e.multiply(n).multiply(2n),f=n.square();return new d([i.mulByNonresidue().add(r),f.mulByNonresidue().add(a),a.add(t.subtract(e).add(n).square()).add(i).subtract(r).subtract(f)])}invert(){let[t,e,n]=this.c,r=t.square().subtract(n.multiply(e).mulByNonresidue()),a=n.square().mulByNonresidue().subtract(t.multiply(e)),i=e.square().subtract(t.multiply(n)),f=n.multiply(a).add(e.multiply(i)).mulByNonresidue().add(t.multiply(r)).invert();return new d([f.multiply(r),f.multiply(a),f.multiply(i)])}frobeniusMap(t){return new d([this.c[0].frobeniusMap(t),this.c[1].frobeniusMap(t).multiply(C[t%6]),this.c[2].frobeniusMap(t).multiply(U[t%6])])}}e.Fp6=d,d.ZERO=new d([o.ZERO,o.ZERO,o.ZERO]),d.ONE=new d([o.ONE,o.ZERO,o.ZERO]);class p extends l{constructor(t){if(super(),this.c=t,2!==t.length)throw new Error("Expected array with 2 elements")}static fromTuple(t){return new p([d.fromTuple(t.slice(0,6)),d.fromTuple(t.slice(6,12))])}init(t){return new p(t)}toString(){return`Fp12(${this.c[0]} + ${this.c[1]} * w)`}multiply(t){if("bigint"==typeof t)return new p([this.c[0].multiply(t),this.c[1].multiply(t)]);let[e,n]=this.c;const[r,a]=t.c;let i=e.multiply(r),f=n.multiply(a);return new p([i.add(f.mulByNonresidue()),e.add(n).multiply(r.add(a)).subtract(i.add(f))])}multiplyBy014(t,e,n){let[r,a]=this.c,[i,f]=[r.multiplyBy01(t,e),a.multiplyBy1(n)];return new p([f.mulByNonresidue().add(i),a.add(r).multiplyBy01(t,e.add(n)).subtract(i).subtract(f)])}multiplyByFp2(t){return this.init(this.map((e=>e.multiplyByFp2(t))))}square(){let[t,e]=this.c,n=t.multiply(e);return new p([e.mulByNonresidue().add(t).multiply(t.add(e)).subtract(n).subtract(n.mulByNonresidue()),n.add(n)])}invert(){let[t,e]=this.c,n=t.square().subtract(e.square().mulByNonresidue()).invert();return new p([t.multiply(n),e.multiply(n).negate()])}frobeniusMap(t){const[e,n]=this.c;let r=e.frobeniusMap(t),[a,i,f]=n.frobeniusMap(t).c;const u=q[t%12];return new p([r,new d([a.multiply(u),i.multiply(u),f.multiply(u)])])}Fp4Square(t,e){const n=t.square(),r=e.square();return[r.mulByNonresidue().add(n),t.add(e).square().subtract(n).subtract(r)]}cyclotomicSquare(){const[t,e]=this.c,[n,r,a]=t.c,[i,f,u]=e.c;let[s,c]=this.Fp4Square(n,f),[l,o]=this.Fp4Square(i,a),[b,y]=this.Fp4Square(r,u),m=y.mulByNonresidue();return new p([new d([s.subtract(n).multiply(2n).add(s),l.subtract(r).multiply(2n).add(l),b.subtract(a).multiply(2n).add(b)]),new d([m.add(i).multiply(2n).add(m),c.add(f).multiply(2n).add(c),o.add(u).multiply(2n).add(o)])])}cyclotomicExp(t){let e=p.ONE;for(let r=n-1;r>=0;r--)e=e.cyclotomicSquare(),f(t,r)&&(e=e.multiply(this));return e}finalExponentiate(){const{x:t}=e.CURVE,n=this.frobeniusMap(6).div(this),r=n.frobeniusMap(2).multiply(n),a=r.cyclotomicExp(t).conjugate(),i=r.cyclotomicSquare().conjugate().multiply(a),f=i.cyclotomicExp(t).conjugate(),u=f.cyclotomicExp(t).conjugate(),s=u.cyclotomicExp(t).conjugate().multiply(a.cyclotomicSquare()),c=s.cyclotomicExp(t).conjugate(),l=a.multiply(u).frobeniusMap(2),o=f.multiply(r).frobeniusMap(3),d=s.multiply(r.conjugate()).frobeniusMap(1),p=c.multiply(i.conjugate()).multiply(r);return l.multiply(o).multiply(d).multiply(p)}}e.Fp12=p,p.ZERO=new p([d.ZERO,d.ZERO]),p.ONE=new p([d.ONE,d.ZERO]);function b(t){const[e,n]=t.values;return BigInt(e%2n||0n===e&&n%2n)}e.ProjectivePoint=class{constructor(t,e,n,r){this.x=t,this.y=e,this.z=n,this.C=r}isZero(){return this.z.isZero()}createPoint(t,e,n){return new this.constructor(t,e,n)}getZero(){return this.createPoint(this.C.ONE,this.C.ONE,this.C.ZERO)}equals(t){if(this.constructor!==t.constructor)throw new Error(`ProjectivePoint#equals: this is ${this.constructor}, but rhs is ${t.constructor}`);const e=this,n=t,r=e.x.multiply(n.z).equals(n.x.multiply(e.z)),a=e.y.multiply(n.z).equals(n.y.multiply(e.z));return r&&a}negate(){return this.createPoint(this.x,this.y.negate(),this.z)}toString(t=!0){if(!t)return`Point<x=${this.x}, y=${this.y}, z=${this.z}>`;const[e,n]=this.toAffine();return`Point<x=${e}, y=${n}>`}fromAffineTuple(t){return this.createPoint(t[0],t[1],this.C.ONE)}toAffine(t=this.z.invert()){return[this.x.multiply(t),this.y.multiply(t)]}toAffineBatch(t){const e=function(t,e){const n=e.length,r=new Array(n);let a=t.ONE;for(let t=0;t<n;t++)e[t].isZero()||(r[t]=a,a=a.multiply(e[t]));a=a.invert();for(let t=n-1;t>=0;t--){if(e[t].isZero())continue;let n=a.multiply(e[t]);e[t]=a.multiply(r[t]),a=n}return e}(this.C,t.map((t=>t.z)));return t.map(((t,n)=>t.toAffine(e[n])))}normalizeZ(t){return this.toAffineBatch(t).map((t=>this.fromAffineTuple(t)))}double(){const{x:t,y:e,z:n}=this,r=t.multiply(t).multiply(3n),a=e.multiply(n),i=a.multiply(a),f=i.multiply(a),u=t.multiply(e).multiply(a),s=r.multiply(r).subtract(u.multiply(8n)),c=s.multiply(a).multiply(2n),l=r.multiply(u.multiply(4n).subtract(s)).subtract(e.multiply(e).multiply(8n).multiply(i)),o=f.multiply(8n);return this.createPoint(c,l,o)}add(t){if(this.constructor!==t.constructor)throw new Error(`ProjectivePoint#add: this is ${this.constructor}, but rhs is ${t.constructor}`);const e=this,n=t;if(e.isZero())return n;if(n.isZero())return e;const r=e.x,a=e.y,i=e.z,f=n.x,u=n.y,s=n.z,c=u.multiply(i),l=a.multiply(s),o=f.multiply(i),d=r.multiply(s);if(o.equals(d)&&c.equals(l))return this.double();if(o.equals(d))return this.getZero();const p=c.subtract(l),b=o.subtract(d),y=b.multiply(b),m=y.multiply(b),h=d.multiply(y),w=i.multiply(s),g=p.multiply(p).multiply(w).subtract(m).subtract(h.multiply(2n)),E=b.multiply(g),x=p.multiply(h.subtract(g)).subtract(m.multiply(l)),v=m.multiply(w);return this.createPoint(E,x,v)}subtract(t){if(this.constructor!==t.constructor)throw new Error(`ProjectivePoint#subtract: this is ${this.constructor}, but rhs is ${t.constructor}`);return this.add(t.negate())}validateScalar(t){if("number"==typeof t&&(t=BigInt(t)),"bigint"!=typeof t||t<=0||t>e.CURVE.r)throw new Error(`Point#multiply: invalid scalar, expected positive integer < CURVE.r. Got: ${t}`);return t}multiplyUnsafe(t){let e=this.validateScalar(t),n=this.getZero(),r=this;for(;e>0n;)1n&e&&(n=n.add(r)),r=r.double(),e>>=1n;return n}multiply(t){let e=this.validateScalar(t),n=this.getZero(),r=this.getZero(),a=this,i=s.ORDER;for(;i>0n;)1n&e?n=n.add(a):r=r.add(a),a=a.double(),e>>=1n,i>>=1n;return n}maxBits(){return this.C.MAX_BITS}precomputeWindow(t){const e=Math.ceil(this.maxBits()/t),n=2**(t-1);let r=[],a=this,i=a;for(let t=0;t<e;t++){i=a,r.push(i);for(let t=1;t<n;t++)i=i.add(a),r.push(i);a=i.double()}return r}calcMultiplyPrecomputes(t){if(this._MPRECOMPUTES)throw new Error("This point already has precomputes");this._MPRECOMPUTES=[t,this.normalizeZ(this.precomputeWindow(t))]}clearMultiplyPrecomputes(){this._MPRECOMPUTES=void 0}wNAF(t){let e,n;this._MPRECOMPUTES?[e,n]=this._MPRECOMPUTES:(e=1,n=this.precomputeWindow(e));let[r,a]=[this.getZero(),this.getZero()];const i=Math.ceil(this.maxBits()/e),f=2**(e-1),u=BigInt(2**e-1),s=2**e,c=BigInt(e);for(let e=0;e<i;e++){const i=e*f;let l=Number(t&u);if(t>>=c,l>f&&(l-=s,t+=1n),0===l)a=a.add(e%2?n[i].negate():n[i]);else{const t=n[i+Math.abs(l)-1];r=r.add(l<0?t.negate():t)}}return[r,a]}multiplyPrecomputed(t){return this.wNAF(this.validateScalar(t))[0]}};const y=(e.CURVE.P**2n-9n)/16n;e.map_to_curve_simple_swu_9mod16=function(t){const e=new o([0n,240n]),n=new o([1012n,1012n]),r=new o([-2n,-1n]);Array.isArray(t)&&(t=new o(t));const a=t.pow(2n),i=r.multiply(a),f=i.add(i.pow(2n));let u=e.multiply(f).negate(),s=n.multiply(f.add(o.ONE));u.isZero()&&(u=r.multiply(e));let c=u.pow(3n),l=s.pow(3n).add(e.multiply(s).multiply(u.pow(2n))).add(n.multiply(c));const[d,p]=function(t,e){const n=e.pow(7n),r=t.multiply(n),a=r.multiply(n.multiply(e)).pow(y).multiply(r);let i=!1,f=a;const u=S.slice(0,4);for(const n of u){const r=n.multiply(a);r.pow(2n).multiply(e).subtract(t).isZero()&&!i&&(i=!0,f=r)}return[i,f]}(l,c);let m;d&&(m=p);const h=p.multiply(t.pow(3n));l=i.pow(3n).multiply(l);let w=!1;for(const t of Z){const e=t.multiply(h);!e.pow(2n).multiply(c).subtract(l).isZero()||d||w||(m=e,w=!0)}if(!d&&!w)throw new Error("Hash to Curve - Optimized SWU failure");return w&&(s=s.multiply(i)),m=m,b(t)!==b(m)&&(m=m.negate()),m=m.multiply(u),[s,m,u]},e.isogenyMapG2=function(t){const[e,n,r]=t,a=r.multiply(r),i=a.multiply(r),f=[r,a,i],u=[o.ZERO,o.ZERO,o.ZERO,o.ZERO];for(let t=0;t<N.length;t++){const n=N[t];u[t]=n.slice(-1)[0];const r=n.slice(0,-1).reverse();for(let n=0;n<r.length;n++){const a=r[n];u[t]=u[t].multiply(e).add(f[n].multiply(a))}}u[2]=u[2].multiply(n),u[3]=u[3].multiply(r);const s=u[1].multiply(u[3]);return[u[0].multiply(u[3]),u[1].multiply(u[2]),s]},e.calcPairingPrecomputes=function(t,r){const[a,i,u]=[t,r,o.ONE];let[s,c,l]=[a,i,u],d=[];for(let t=n-2;t>=0;t--){let n=c.square(),r=l.square(),u=r.multiply(3n).multiplyByB(),o=u.multiply(3n),p=c.add(l).square().subtract(r).subtract(n);if(d.push([u.subtract(n),s.square().multiply(3n),p.negate()]),s=n.subtract(o).multiply(s).multiply(c).div(2n),c=n.add(o).div(2n).square().subtract(u.square().multiply(3n)),l=n.multiply(p),f(e.CURVE.x,t)){let t=c.subtract(i.multiply(l)),e=s.subtract(a.multiply(l));d.push([t.multiply(a).subtract(e.multiply(i)),t.negate(),e]);let n=e.square(),r=n.multiply(e),f=n.multiply(s),u=r.subtract(f.multiply(2n)).add(t.square().multiply(l));s=e.multiply(u),c=f.subtract(u).multiply(t).subtract(r.multiply(c)),l=l.multiply(r)}}return d},e.millerLoop=function(t,r){let a=p.ONE;const[i,u]=r,[s,c]=[i,u];for(let r=0,i=n-2;i>=0;i--,r++)a=a.multiplyBy014(t[r][0],t[r][1].multiply(s.value),t[r][2].multiply(c.value)),f(e.CURVE.x,i)&&(r+=1,a=a.multiplyBy014(t[r][0],t[r][1].multiply(s.value),t[r][2].multiply(c.value))),0!==i&&(a=a.square());return a.conjugate()};const m=new d([o.ZERO,o.ONE,o.ZERO]),h=new p([m,d.ZERO]),w=h.invert(),g=new p([d.ZERO,m]),E=g.invert();e.psi=function(t,e){return[w.multiplyByFp2(t).frobeniusMap(1).multiply(h).c[0].c[0],E.multiplyByFp2(e).frobeniusMap(1).multiply(g).c[0].c[0]]},e.psi2=function(t,e){return[t.multiply(x),e.negate()]};const x=0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,v=0x6af0e0437ff400b6831e36d6bd17ffe48395dabc2d3435e77f76e17009241c5ee67992f72ec05f4c81084fbede3cc09n,R=0x699be3b8c6870965e5bf892ad5d2cc7b0e85a117402dfd83b7f4a947e02d978498255a2aaec0ac627b5afbdf1bf1c90n,P=0x8157cd83046453f5dd0972b6e3949e4288020b5b8a9cc99ca07e27089a2ce2436d965026adad3ef7baba37f2183e9b5n,O=0xab1c2ffdd6c253ca155231eb3e71ba044fd562f6f72bc5bad5ec46a0b7a3b0247cf08ce6c6317f40edbc653a72dee17n,F=0xaa404866706722864480885d68ad0ccac1967c7544b447873cc37e0181271e006df72162a3d3e0287bf597fbf7f8fc1n,B=[0x1n,0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaaan].map((t=>new s(t))),S=[[1n,0n],[v,-v],[0n,1n],[v,v],[-1n,0n],[-v,v],[0n,-1n],[-v,-v]].map((t=>new o(t))),Z=[[R,P],[-P,R],[O,F],[-F,O]].map((t=>new o(t))),C=[[0x1n,0x0n],[0x0n,0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn],[0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,0x0n],[0x0n,0x1n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,0x0n],[0x0n,0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen]].map((t=>new o(t))),U=[[0x1n,0x0n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaadn,0x0n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,0x0n],[0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaaan,0x0n],[0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,0x0n],[0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffeffffn,0x0n]].map((t=>new o(t))),q=[[0x1n,0x0n],[0x1904d3bf02bb0667c231beb4202c0d1f0fd603fd3cbd5f4f7b2443d784bab9c4f67ea53d63e7813d8d0775ed92235fb8n,0x00fc3e2b36c4e03288e9e902231f9fb854a14787b6c7b36fec0c8ec971f63c5f282d5ac14d6c7ec22cf78a126ddc4af3n],[0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffeffffn,0x0n],[0x135203e60180a68ee2e9c448d77a2cd91c3dedd930b1cf60ef396489f61eb45e304466cf3e67fa0af1ee7b04121bdea2n,0x06af0e0437ff400b6831e36d6bd17ffe48395dabc2d3435e77f76e17009241c5ee67992f72ec05f4c81084fbede3cc09n],[0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,0x0n],[0x144e4211384586c16bd3ad4afa99cc9170df3560e77982d0db45f3536814f0bd5871c1908bd478cd1ee605167ff82995n,0x05b2cfd9013a5fd8df47fa6b48b1e045f39816240c0b8fee8beadf4d8e9c0566c63a3e6e257f87329b18fae980078116n],[0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaaan,0x0n],[0x00fc3e2b36c4e03288e9e902231f9fb854a14787b6c7b36fec0c8ec971f63c5f282d5ac14d6c7ec22cf78a126ddc4af3n,0x1904d3bf02bb0667c231beb4202c0d1f0fd603fd3cbd5f4f7b2443d784bab9c4f67ea53d63e7813d8d0775ed92235fb8n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,0x0n],[0x06af0e0437ff400b6831e36d6bd17ffe48395dabc2d3435e77f76e17009241c5ee67992f72ec05f4c81084fbede3cc09n,0x135203e60180a68ee2e9c448d77a2cd91c3dedd930b1cf60ef396489f61eb45e304466cf3e67fa0af1ee7b04121bdea2n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaadn,0x0n],[0x05b2cfd9013a5fd8df47fa6b48b1e045f39816240c0b8fee8beadf4d8e9c0566c63a3e6e257f87329b18fae980078116n,0x144e4211384586c16bd3ad4afa99cc9170df3560e77982d0db45f3536814f0bd5871c1908bd478cd1ee605167ff82995n]].map((t=>new o(t))),N=[[[0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6n,0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6n],[0x0n,0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71an],[0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71en,0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38dn],[0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1n,0x0n]].map((t=>new o(t))),[[0x0n,0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63n],[0xcn,0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9fn],[0x1n,0x0n],[0x0n,0x0n]].map((t=>new o(t))),[[0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706n,0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706n],[0x0n,0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97ben],[0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71cn,0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38fn],[0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10n,0x0n]].map((t=>new o(t))),[[0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fbn,0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fbn],[0x0n,0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3n],[0x12n,0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99n],[0x1n,0x0n]].map((t=>new o(t)))]})),r=t((function(t,r){
/*! noble-bls12-381 - MIT License (c) Paul Miller (paulmillr.com) */
Object.defineProperty(r,"__esModule",{value:!0}),r.verifyBatch=r.aggregateSignatures=r.aggregatePublicKeys=r.verify=r.sign=r.getPublicKey=r.pairing=r.PointG2=r.PointG1=r.utils=r.CURVE=r.Fp12=r.Fp2=r.Fr=r.Fp=void 0,Object.defineProperty(r,"Fp",{enumerable:!0,get:function(){return n.Fp}}),Object.defineProperty(r,"Fr",{enumerable:!0,get:function(){return n.Fr}}),Object.defineProperty(r,"Fp2",{enumerable:!0,get:function(){return n.Fp2}}),Object.defineProperty(r,"Fp12",{enumerable:!0,get:function(){return n.Fp12}}),Object.defineProperty(r,"CURVE",{enumerable:!0,get:function(){return n.CURVE}});const a=2n**381n,i=2n*a,f=2n*i,u=48;let s="BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_";const c={DST:s,p:n.CURVE.P,m:2,k:128,expand:!0};function l(t){return 0<t&&t<n.CURVE.r}const o=(()=>{const n="object"==typeof self&&"crypto"in self?self.crypto:void 0,r=e.bind(t);return{node:r&&!n?r("crypto"):void 0,web:n}})();function d(t){let e=0n;for(let n=t.length-1,r=0;n>=0;n--,r++)e+=(255n&BigInt(t[n]))<<8n*BigInt(r);return e}function p(t){let e="";for(let n=0;n<t.length;n++)e+=t[n].toString(16).padStart(2,"0");return e}function b(t){if("string"!=typeof t)throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const e=new Uint8Array(t.length/2);for(let n=0;n<e.length;n++){const r=2*n;e[n]=Number.parseInt(t.slice(r,r+2),16)}return e}function y(t,e){if(t<0n)throw new Error("Expected valid number");if("number"!=typeof e)throw new TypeError("Expected valid padding");return t.toString(16).padStart(2*e,"0")}function m(t){if(t instanceof Uint8Array)return t;if("string"==typeof t)return b(t);throw new TypeError("Expected hex string or Uint8Array")}function h(...t){if(1===t.length)return t[0];const e=t.reduce(((t,e)=>t+e.length),0),n=new Uint8Array(e);for(let e=0,r=0;e<t.length;e++){const a=t[e];n.set(a,r),r+=a.length}return n}function w(t){let e=0n;for(let n=0;n<t.length;n++)e<<=8n,e+=BigInt(t[n]);return e}function g(t,e){if(t<0||t>=1<<8*e)throw new Error(`bad I2OSP call: value=${t} length=${e}`);const n=Array.from({length:e}).fill(0);for(let r=e-1;r>=0;r--)n[r]=255&t,t>>>=8;return new Uint8Array(n)}function E(t,e){const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t[r]^e[r];return n}async function x(t,e,a={}){const i={...c,...a},f=i.p.toString(2).length,u=Math.ceil((f+i.k)/8),s=e*i.m*u,l=function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(i.DST);let o=t;i.expand&&(o=await async function(t,e,n){const a=r.utils.sha256,i=Math.ceil(n/32);if(i>255)throw new Error("Invalid xmd length");const f=h(e,g(e.length,1)),u=g(0,64),s=g(n,2),c=new Array(i),l=await a(h(u,t,s,g(0,1),f));c[0]=await a(h(l,g(1,1),f));for(let t=1;t<=i;t++){const e=[E(l,c[t-1]),g(t+1,1),f];c[t]=await a(h(...e))}return h(...c).slice(0,n)}(t,l,s));const d=new Array(e);for(let t=0;t<e;t++){const e=new Array(i.m);for(let r=0;r<i.m;r++){const a=u*(r+t*i.m),f=o.slice(a,a+u);e[r]=n.mod(w(f),i.p)}d[t]=e}return d}function v(t){let e;if(t instanceof Uint8Array&&32===t.length)e=d(t);else if("string"==typeof t&&64===t.length)e=BigInt(`0x${t}`);else if("number"==typeof t&&t>0&&Number.isSafeInteger(t))e=BigInt(t);else{if(!("bigint"==typeof t&&t>0n))throw new TypeError("Expected valid private key");e=t}if(e=n.mod(e,n.CURVE.r),!l(e))throw new Error("Private key must be 0 < key < CURVE.r");return e}function R(t,e){if(!(t instanceof e))throw new Error("Expected Fp* argument, not number/bigint")}r.utils={hashToField:x,randomBytes:(t=32)=>{if(o.web)return o.web.getRandomValues(new Uint8Array(t));if(o.node){const{randomBytes:e}=o.node;return new Uint8Array(e(t).buffer)}throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>{let t=8;for(;t--;){const t=r.utils.randomBytes(32),e=d(t);if(l(e)&&1n!==e)return t}throw new Error("Valid private key was not found in 8 iterations. PRNG is broken")},sha256:async t=>{if(o.web){const e=await o.web.subtle.digest("SHA-256",t.buffer);return new Uint8Array(e)}if(o.node)return Uint8Array.from(o.node.createHash("sha256").update(t).digest());throw new Error("The environment doesn't have sha256 function")},mod:n.mod,getDSTLabel:()=>s,setDSTLabel(t){if("string"!=typeof t||t.length>2048||0===t.length)throw new TypeError("Invalid DST");s=t}};class P extends n.ProjectivePoint{constructor(t,e,r=n.Fp.ONE){super(t,e,r,n.Fp),R(t,n.Fp),R(e,n.Fp),R(r,n.Fp)}static fromHex(t){t=m(t);const{P:e}=n.CURVE;let r;if(48===t.length){const u=d(t);if(1n===n.mod(u,f)/i)return this.ZERO;const s=new n.Fp(n.mod(u,a));let c=s.pow(3n).add(new n.Fp(n.CURVE.b)).sqrt();if(!c)throw new Error("Invalid compressed G1 point");const l=n.mod(u,i)/a;2n*c.value/e!==l&&(c=c.negate()),r=new P(s,c)}else{if(96!==t.length)throw new Error("Invalid point G1, expected 48/96 bytes");{if(0!=(64&t[0]))return P.ZERO;const e=d(t.slice(0,u)),a=d(t.slice(u));r=new P(new n.Fp(e),new n.Fp(a))}}return r.assertValidity(),r}static fromPrivateKey(t){return this.BASE.multiplyPrecomputed(v(t))}toRawBytes(t=!1){return b(this.toHex(t))}toHex(t=!1){this.assertValidity();const{P:e}=n.CURVE;if(t){let t;if(this.isZero())t=f+i;else{const[n,r]=this.toAffine(),i=2n*r.value/e;t=n.value+i*a+f}return y(t,u)}if(this.isZero())return"4".padEnd(192,"0");{const[t,e]=this.toAffine();return y(t.value,u)+y(e.value,u)}}assertValidity(){if(this.isZero())return this;if(!this.isOnCurve())throw new Error("Invalid G1 point: not on curve Fp");if(!this.isTorsionFree())throw new Error("Invalid G1 point: must be of prime-order subgroup");return this}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}millerLoop(t){return n.millerLoop(t.pairingPrecomputes(),this.toAffine())}clearCofactor(){return this.multiplyUnsafe(n.CURVE.h)}isOnCurve(){const t=new n.Fp(n.CURVE.b),{x:e,y:r,z:a}=this,i=r.pow(2n).multiply(a).subtract(e.pow(3n)),f=t.multiply(a.pow(3n));return i.subtract(f).isZero()}sigma(){const[t,e]=this.toAffine();return new P(t.multiply(0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn),e)}isTorsionFree(){const t=this.sigma(),e=t.double(),n=t.sigma();return e.subtract(this).subtract(n).multiplyUnsafe(0x396c8c005555e1560000000055555555n).subtract(n).isZero()}}r.PointG1=P,P.BASE=new P(new n.Fp(n.CURVE.Gx),new n.Fp(n.CURVE.Gy),n.Fp.ONE),P.ZERO=new P(n.Fp.ONE,n.Fp.ONE,n.Fp.ZERO);class O extends n.ProjectivePoint{constructor(t,e,r=n.Fp2.ONE){super(t,e,r,n.Fp2),R(t,n.Fp2),R(e,n.Fp2),R(r,n.Fp2)}static async hashToCurve(t){t=m(t);const e=await x(t,2),r=new O(...n.isogenyMapG2(n.map_to_curve_simple_swu_9mod16(e[0]))),a=new O(...n.isogenyMapG2(n.map_to_curve_simple_swu_9mod16(e[1])));return r.add(a).clearCofactor()}static fromSignature(t){t=m(t);const{P:e}=n.CURVE,r=t.length/2;if(48!==r&&96!==r)throw new Error("Invalid compressed signature length, must be 96 or 192");const u=d(t.slice(0,r)),s=d(t.slice(r));if(1n===n.mod(u,f)/i)return this.ZERO;const c=u%a,l=s,o=new n.Fp2([l,c]);let p=o.pow(3n).add(new n.Fp2(n.CURVE.b2)).sqrt();if(!p)throw new Error("Failed to find a square root");const[b,y]=p.values,h=u%i/a;(y>0n&&2n*y/e!==h||0n===y&&2n*b/e!==h)&&(p=p.multiply(-1n));const w=new O(o,p,n.Fp2.ONE);return w.assertValidity(),w}static fromHex(t){let e;if(96===(t=m(t)).length)throw new Error("Compressed format not supported yet.");if(192!==t.length)throw new Error("Invalid uncompressed point G2, expected 192 bytes");{if(0!=(64&t[0]))return O.ZERO;const r=d(t.slice(0,u)),a=d(t.slice(u,96)),i=d(t.slice(96,144)),f=d(t.slice(144));e=new O(new n.Fp2([a,r]),new n.Fp2([f,i]))}return e.assertValidity(),e}static fromPrivateKey(t){return this.BASE.multiplyPrecomputed(v(t))}toSignature(){if(this.equals(O.ZERO)){return y(f+i,u)+y(0n,u)}const[[t,e],[r,s]]=this.toAffine().map((t=>t.values)),c=t;return y(e+(s>0n?2n*s:2n*r)/n.CURVE.P*a+f,u)+y(c,u)}toRawBytes(t=!1){return b(this.toHex(t))}toHex(t=!1){if(this.assertValidity(),t)throw new Error("Point compression has not yet been implemented");{if(this.equals(O.ZERO))return"4".padEnd(384,"0");const[[t,e],[n,r]]=this.toAffine().map((t=>t.values));return y(e,u)+y(t,u)+y(r,u)+y(n,u)}}assertValidity(){if(this.isZero())return this;if(!this.isOnCurve())throw new Error("Invalid G2 point: not on curve Fp2");if(!this.isTorsionFree())throw new Error("Invalid G2 point: must be of prime-order subgroup");return this}psi(){return this.fromAffineTuple(n.psi(...this.toAffine()))}psi2(){return this.fromAffineTuple(n.psi2(...this.toAffine()))}mulNegX(){return this.multiplyUnsafe(n.CURVE.x).negate()}clearCofactor(){const t=this;let e=t.mulNegX(),n=t.psi(),r=t.double();r=r.psi2(),r=r.subtract(n),n=e.add(n),n=n.mulNegX(),r=r.add(n),r=r.subtract(e);return r.subtract(t)}isOnCurve(){const t=new n.Fp2(n.CURVE.b2),{x:e,y:r,z:a}=this,i=r.pow(2n).multiply(a).subtract(e.pow(3n)),f=t.multiply(a.pow(3n));return i.subtract(f).isZero()}isTorsionFree(){const t=this.psi2();return t.psi().mulNegX().subtract(t).add(this).isZero()}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}clearPairingPrecomputes(){this._PPRECOMPUTES=void 0}pairingPrecomputes(){return this._PPRECOMPUTES||(this._PPRECOMPUTES=n.calcPairingPrecomputes(...this.toAffine())),this._PPRECOMPUTES}}function F(t,e,n=!0){if(t.isZero()||e.isZero())throw new Error("No pairings at point of Infinity");t.assertValidity(),e.assertValidity();const r=t.millerLoop(e);return n?r.finalExponentiate():r}function B(t){return t instanceof P?t:P.fromHex(t)}function S(t){return t instanceof O?t:O.fromSignature(t)}async function Z(t){return t instanceof O?t:O.hashToCurve(t)}r.PointG2=O,O.BASE=new O(new n.Fp2(n.CURVE.G2x),new n.Fp2(n.CURVE.G2y),n.Fp2.ONE),O.ZERO=new O(n.Fp2.ONE,n.Fp2.ONE,n.Fp2.ZERO),r.pairing=F,r.getPublicKey=function(t){const e=P.fromPrivateKey(t).toRawBytes(!0);return"string"==typeof t?p(e):e},r.sign=async function(t,e){const n=await Z(t);n.assertValidity();const r=n.multiply(v(e));if(t instanceof O)return r;const a=r.toSignature();return"string"==typeof t?a:b(a)},r.verify=async function(t,e,r){const a=B(r),i=await Z(e),f=P.BASE,u=S(t),s=F(a.negate(),i,!1);return F(f,u,!1).multiply(s).finalExponentiate().equals(n.Fp12.ONE)},r.aggregatePublicKeys=function(t){if(!t.length)throw new Error("Expected non-empty array");const e=t.map(B).reduce(((t,e)=>t.add(e)),P.ZERO);if(t[0]instanceof P)return e.assertValidity();const n=e.toRawBytes(!0);return t[0]instanceof Uint8Array?n:p(n)},r.aggregateSignatures=function(t){if(!t.length)throw new Error("Expected non-empty array");const e=t.map(S).reduce(((t,e)=>t.add(e)),O.ZERO);if(t[0]instanceof O)return e.assertValidity();const n=e.toSignature();return t[0]instanceof Uint8Array?b(n):n},r.verifyBatch=async function(t,e,r){if(!e.length)throw new Error("Expected non-empty messages array");if(r.length!==e.length)throw new Error("Pubkey count should equal msg count");const a=S(t),i=await Promise.all(e.map(Z)),f=r.map(B);try{const t=[];for(const e of new Set(i)){const n=i.reduce(((t,n,r)=>n===e?t.add(f[r]):t),P.ZERO);t.push(F(n,e,!1))}t.push(F(P.BASE.negate(),a,!1));const e=t.reduce(((t,e)=>t.multiply(e)),n.Fp12.ONE);return e.finalExponentiate().equals(n.Fp12.ONE)}catch{return!1}},P.BASE.calcMultiplyPrecomputes(4)}));const a=t=>new r.Fr(f(i(t))),i=t=>{t.startsWith("0x")&&(t=t.slice(2));const e=t.length;let n="";for(let r=0;r<e/2;r++)n+=t.substring(e-2*(r+1),e-2*r);return n},f=t=>BigInt(`0x${t}`);return{addG1:(t,e)=>{const n=r.PointG1.fromHex(t);n.assertValidity();const a=r.PointG1.fromHex(e);return a.assertValidity(),n.add(a).toHex()},addG2:(t,e)=>{const n=r.PointG2.fromHex(t);n.assertValidity();const a=r.PointG2.fromHex(e);return a.assertValidity(),n.add(a).toHex()},addFr:(t,e)=>{const n=a(t),r=a(e);return i(n.add(r).toString())},multiplyG1ByFr:(t,e)=>{const n=r.PointG1.fromHex(t);return n.assertValidity(),n.multiply(f(i(e))).toHex()},multiplyG2ByFr:(t,e)=>{const n=r.PointG2.fromHex(t);return n.assertValidity(),n.multiply(f(i(e))).toHex()},multiplyFrByFr:(t,e)=>{const n=a(t),r=a(e);return i(n.multiply(r).toString())},multiplyFrByInt:(t,e)=>i(a(t).multiply(BigInt(e)).toString()),negateG1:t=>{const e=r.PointG1.fromHex(t).negate();return e.assertValidity(),e.toHex()},negateG2:t=>{const e=r.PointG2.fromHex(t).negate();return e.assertValidity(),e.toHex()},negateFr:t=>{const e=a(t);return i(e.negate().toString())},convertFrToInt:t=>f(i(t)).toString(10),pairingCheck:t=>{let e=!0;if(t.length>0){const n=r.PointG1.fromHex(t[0][0]);n.assertValidity();const a=r.PointG2.fromHex(t[0][1]);a.assertValidity();const i=r.PointG1.fromHex(t[1][0]);i.assertValidity();const f=r.PointG2.fromHex(t[1][1]);f.assertValidity();const u=r.pairing(n,a),s=r.pairing(i,f);e=u.multiply(s).equals(r.Fp12.ONE)}return e}}}();